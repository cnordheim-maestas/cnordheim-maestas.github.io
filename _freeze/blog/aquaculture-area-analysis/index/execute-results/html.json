{
  "hash": "c80e9f1bb76ceedb61a59d760c1119df",
  "result": {
    "markdown": "---\ntitle: \"Aquaculture Area Analysis\"\ndescription: \"Geospatial analysis of suitable habitat for marine aquaculture\"\nauthor: \n- name: Caitlin Nordheim-Maestas\n  url: https://cnordheim-maestas.github.io/\n  orcid: 0000-0002-9786-060X\n  affiliation: MEDS coursework at UC Santa Barbara\n  affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science/academics-meds\ndate: \"2025-12-11\"\nimage: aquaculture_area_fig.jpeg\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\nformat:\n  html:\n    code-tools: true\n    code-fold: true\n    code-summary: \"Show the code\"\n    toc: true\n---\n\n\n# Research Question & Background\n\nResearch Question: **Which areas along the U.S. West Coast should be prioritized for marine aquaculture development, based on habitat suitability for multiple commercially important species?**\n\n## Background\n\nIn an era where we are facing an increasing global human population alongside historic losses of biodiversity and overfishing it is vital to focus on sustainable ways to feed our world. Marine aquaculture, especially offshore marine aquaculture (Froehlich et al. 2017), poses a promising future for a more sustainable method of obtaining enough animal protein to meet global demand for animal protein (Gentry et al 2017). First, it is vital to identify what areas to target for the development of marine aquaculture, but this will likely be species-specific, as different species' physiologies will determine what areas in the ocean are suitable for them. I will focus on determining the suitable area for different species based on their **depth tolerance** and **temperature tolerance**, first with oysters, then in a more generalized workflow that allows for the exploration of other marine species.\n\nMoreover, I will demonstrate the utility of the generalized function in R to visualize the areas that are suitable for Red Urchin. Sea urchin aquaculture would be widely applicable for society, as sea urchins are not only harvested for their uni and roe for consumption, but they also contain molecules of pharmaceutical importance for ocular disease investigation, and for biologically active food development (Rubilar & Cardozo 2021).\n\n# Data description\n\nI am using **Sea Surface Temperature (SST)** and **Bathymetry** data from the ocean off the West Coast of the USA to calculate the suitable habitat in each of the **exclusive economic zones (EEZ)** in the area for different marine species of aquaculture interest. Exclusive economic zones are the marine area off the coast of an area where the rights to the area's resources and exploration belong to the owner of that geographic zone.\n\nThe **SST** data was generated from the NOAA Coral Reef Watch 5km Daily Global Satellite Sea Surface Temperature Anomaly, version 3.1, for the years 2008-2012. This is **raster data**, and each year is a separate raster file, so I averaged the SST for each point across the four years and converted to Celsius.\n\nThe **Bathymetry** data was obtained using General Bathymetric Chart of the Oceans (GEBCO), for the area west of the USA. This is also **raster data**, all in a single raster file, showing the depth across the geographic area.\n\nIn order to determine habitat suitability for certain organisms of aquaculture importance, I used **SeaLifeBase** to gather the minimum and maximum temperature and depth the species can survive at, which are input into analysis. Note that this data was not imported like the other data sources, but rather, the values discovered in the database are manually input into the workflow for each species.\n\nThen, I use the **exclusive economic zone (EEZ)** data, obtained through Marineregions.org, to calculate the suitable area for the species in each of the zones in order to compare across zones. This is **vector data** showing the boundaries of the EEZ's in this area.\n\n# Analysis\n\n## Plan\n\nThe goal of this work is to create a workflow that can be generalized to any marine species in this geographic areas (in the exclusive economic zones off the West coast of the USA). Thus, I will first walk through the building of the workflow (Part A) for one organism type, **oysters**. Then in Part B, I will incorporate all of the aspects of the analysis into one function that can work for any species, demonstrating this on **Red Urchin**.\n\nIn Part A, I will (1) import and clean the data for downstream analysis, (2) Determine and map the suitable locations based on SST and depth for a a species, (3) calculate the suitable area per exclusive economic zone, and (4) build a map of the habitable area per EEZ.\n\nIn Part B, I will take the workflow from Part A and turn it into a single function, that can take in temperature and depth tolerance data for any species, and output a map with the habitable area per exclusive economic zone in this geographic region. I will first demonstrate that the results are the same using the function for oysters, then will use the function on Red Urchin.\n\n## Part A\n\n### A.1: Import & clean data\n\nHere, I read in the data, calculate the average sea surface temperature (and convert to Celsius), ensure the bathymetry raster matches the coordinate reference system, extent, and resolution of the SST, and ensure the exclusive economic zone data matches the crs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries \nlibrary(tidyverse) # data wrangling\nlibrary(janitor) # data wrangling\nlibrary(sf) # for spatial data\nlibrary(tmap) # for pretty maps\nlibrary(here) # file pathing\nlibrary(viridisLite) # colors\nlibrary(patchwork) # combine plots\nlibrary(stars) # rasters\nlibrary(terra) # rasters\n\n#..................Sea Surface Temp (SST) Data...................\n# read in each raster, one per year\nsst_2008 <- rast(here::here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"average_annual_sst_2008.tif\")) \nsst_2009 <- rast(here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"average_annual_sst_2009.tif\"))\nsst_2010 <- rast(here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"average_annual_sst_2010.tif\"))\nsst_2011 <- rast(here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"average_annual_sst_2011.tif\"))\nsst_2012 <- rast(here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"average_annual_sst_2012.tif\"))\n\n# combine SST rasters into a raster stack\nsst <- c(sst_2008, \n         sst_2009, \n         sst_2010, \n         sst_2011, \n         sst_2012)\n\n# assign names to each raster layer\nnames(sst) <- c(\"2008\", \n         \"2009\",\n         \"2010\",\n         \"2011\",\n         \"2012\")\n\n# local algebra to find the mean sst for each spot\nsst_mean <- mean(sst, na.rm = TRUE)\n\n# global algebra to subtract 273.15 to convert from from Kelvin to Celsius\nsst_c <- sst_mean - 273.15\n\n#........................Bathymetry Data.........................\n# read in bathymetry raster\nbath <- rast(here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"depth.tif\"))\n\n# SAME CRS: data check: ensure same crs and reporject if it is not\nif(crs(bath) == crs(sst_c)) {\n # print(\"coordinate reference systems match\") # uncomment this for messages to print\n} else{\n  bath <- project(bath, sst_c) \n}\n\n# SAME EXTENT: crop depth raster to match the extent of the SST raster\n# crop bathymetry raster to extent of sst_c\nbath_crop <- crop(bath, sst_c)\n\n# SAME RESOLUTION: resample to ensure the resolutions match\n# using the nearest neighbor approach\nbath_final <- resample(bath_crop, y = sst_c, \n                          method = \"near\") # for nearest neighbor\n\n#...............Exclusive Economic Zone (EEZ) Data...............\neez <- st_read(here(\"blog\", \"aquaculture-area-analysis\", \"data\", \"wc_regions_clean.shp\"), \n               quiet = TRUE) # no message output\n\n# crs match\nif(crs(eez) == crs(sst_c)) {\n # print(\"coordinate reference systems match\") # uncomment this for messages to print\n} else{\n  eez <- st_transform(eez, crs = st_crs(sst_c))\n}\n```\n:::\n\n\n### A.2: Suitable locations for oysters\n\nNow I will find suitable locations for marine aquaculture in terms of both SST and depth. Here, I will use oysters as an example organism, and **they can only exist between 11-30 degrees C and -70 through 0 meters below sea level**.\n\nI will build matrices for temperature `sst_matrix`, and the depth `bath_matrix`, which include all values from -Infinity to +Infinity, specifying if they are habitable for the species with a 1 or uninhabitable with a 0. Next, I will reclassify the original rasters with whether each area is suitable using its matrix.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# build matrix of habitable (1) and uninhabitable (0) temperatures\nsst_matrix <- matrix(c(-Inf, 11, 0, # temperature too low\n                        11, 30, 1, # habitable temperatures\n                        30, Inf, 0), # temperature too high\n                        ncol = 3, byrow = TRUE)\n\n# use reclassification matrix to reclassify temperature raster to suitable areas according to temp\nsst_rcl <- classify(sst_c, rcl = sst_matrix)\n\n# build matrix of habitable (1) and uninhabitable (0) depths\nbath_matrix <- matrix(c(-Inf, -70, 0, # depth too low\n                        -70, 0, 1, # habitable depth\n                        0, Inf, 0), # depth too high \n                        ncol = 3, byrow = TRUE)\n\n# use reclassification matrix to reclassify bathymetry raster to suitable areas according to depth\nbath_rcl <- classify(bath_final, rcl = bath_matrix)\n```\n:::\n\n\nThe SST and depth rasters now identify the suitability of locations as 0 or 1. To find locations that have both suitable temperature and depth, I can use a map algebra trick and mulitply the rasters together. This works because anything multiplied by 0 equals 0 and anything multiplied by 1 equals itself. Thus, any areas that are uninhabitable due to temperature or depth or both will be 0, and only areas where both are habitable (multiplying 1\\*1) will end up as 1, also known as habitable area.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# determine the suitable cells using the reclassified sst and depth multiplying them\nsuitable_cells <- sst_rcl * bath_rcl\n\n# make 0's NA\nsuitable_cells[suitable_cells == 0] <- NA\n```\n:::\n\n\n### A.3: Area per EEZ\n\nNow that we know which areas off the West Coast of the USA are habitable for our species of interest, here oysters, based on SST and depth, we can calculate how much area is habitable in each exclusive economic zone (EEZ), to allow for comparison across zones. This comparison can lead to management decisions about which zones are the best to explore marine aquaculture development for a specific species of interest.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# crop suitable cells to eez\nsuitable_cropped <- crop(suitable_cells, eez)\n\n# rasterize eez\neez_rast <- rasterize(eez, suitable_cropped, field = \"area_km2\")\n\n# compute the area covered by individual raster cells in km\nsuitable_cropped <- terra::cellSize(suitable_cropped, # Compute the area covered by individual raster cells\n                             mask=TRUE, # If TRUE, cells that are NA remain NA in the output\n                             lyrs=FALSE, # If TRUE and mask=TRUE, the output has the same number of layers as input\n                             unit=\"km\") # report the cell area in km\n\n# use zonal stats to get the sum of the area in each eez\nzones_suitarea <- terra::zonal(suitable_cropped, # x: SpatRaster\n                               eez_rast, # y: needs to be terra object\n                               fun = \"sum\", # sum up the area\n                               na.rm = TRUE) # remember to remove NA's!\n\n# update the column names from the initial dataframe of the eez\nzones_clean <- cbind(eez, zones_suitarea) %>%  \n  # clean dataframe for ease of use\n  dplyr::select(rgn, area_km2, area) %>% # select columns I care about\n  rename(\"suitable_area\" = \"area\") # rename to something prettier\n```\n:::\n\n\n### A.4: Build map\n\nI will now build a map of the amount of habitable area there is for this species (oysters) per exclusive economic zone. This map will visualize the results of the amount of habitable area per EEZ, and allow for easy comparisons across the EEZ to select the zone with the most habitable area. It can be used to explore latitudinal patterns in the habitability for a specific species. Importantly, building a map will allow for easy comparison across different species, when multiple maps are made. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap <- tm_shape(zones_clean) + # vector data, use tmshape. \n    tm_graticules() + # add graticules at this layer\n \n# next layer: fill by area of suitable habitat\n  tm_polygons(fill = \"suitable_area\", # column name with the values\n  # specify the color scale, using viridis because it is colorblind friendly\n              fill.scale = tm_scale(values =  viridis(2)), \n              fill.legend = tm_legend(title = \"Area of suitable habitat (km2)\", \n                                      position = tm_pos_out(\"right\"))) +\n  \n # next layer: show the outlines of the zones clearly\n  tm_borders(col = \"black\") + # borders of the counties\n\n# add map elements\n  tm_title(text = \"Suitable habitat for oysters in each EEZ\") \n\nmap\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Part B: Generalizable workflow\n\nNow that I know that the workflow functions, I am going to take all of the steps done prior and put them into one function that can intake information for any species and output the same map for that species. **This allows for easy comparison across species which will allow for us to determine which EEZ's are best across multiple species and help inform marine aquaculture management.** Functionally, it will save a lot of space to only need to input a species' information rather than repeating the whole workflow. Moreover, it will maximize reproducibility so other can easily use this tool, and minimize the change of small errors in coding that may arise when copy and pasting lots of code in the absence of a single function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuitable_habitat <- function(bath, # bathymetry raster\n                             eez, # eez spatial dataframe\n                             sst_c, # raster of sea surface temp; \n                             #with mean sst for the time period you want\n                             min_sst, # string with the minimum temp in C\n                             max_sst, # string with the max temp in C\n                             min_depth_m, # string with the minimum depth in m\n                             max_depth_m, # string with the maximum temp in m\n                             species_name) # string with species name\n  {\n#...............STEP 1: Bathymetry raster cleaning...............\n  # SAME CRS: project bath to sst_c\n       bath <- project(bath, sst_c) \n  # Now crop to same extent: crop bathymetry raster to extent of sst_c\n    bath_crop <- crop(bath, sst_c)\n  # now ensure in same resolution as sst by resampling, use nearest neighbor\n    bath_final <- resample(bath_crop, y = sst_c, \n                          method = \"near\") # for nearest neighbor\n\n#........STEP 2: build a suitable depth and temp raster.......\n    # build a matrix for reclassifying sst\n      sst_matrix <- matrix(c(-Inf, min_sst, 0, # uninhabitable\n                        min_sst, max_sst, 1, # habitable\n                        max_sst, Inf, 0), # uninhabitable\n                        ncol = 3, byrow = TRUE)\n    # use reclassification matrix to reclassify elevation raster\n    sst_rcl <- classify(sst_c, rcl = sst_matrix)\n  # build a matrix for reclassifying bathymetry\n    bath_matrix <- matrix(c(-Inf, max_depth_m, 0, # uninhabitable\n                        max_depth_m, min_depth_m, 1, # habitable\n                        min_depth_m, Inf, 0), # uninhabitable\n                        ncol = 3, byrow = TRUE)\n    # use reclassification matrix to reclassify elevation raster\n    bath_rcl <- classify(bath_final, rcl = bath_matrix)\n    # determine the suitable cells using the reclassified sst and depth multiplying\n    # call the output suitable_cells\n    suitable_cells <- sst_rcl * bath_rcl\n    # make 0's NA\n    suitable_cells[suitable_cells == 0] <- NA\n\n#..........STEP 3: incorporate exclusive economic zones..........    \n    # crop suitable cells to eez\n    suitable_cropped <- crop(suitable_cells, eez)\n    # rasterize eez\n    eez_rast <- rasterize(eez, suitable_cropped, field = \"area_km2\")\n    # compute the area covered by individual raster cells\n    suitable_cropped <- cellSize(suitable_cropped, mask=TRUE, lyrs=FALSE, unit=\"km\")\n    # use zonal stats\n    zones_suitarea <- terra::zonal(suitable_cropped, # x: SpatRaster\n                               eez_rast, # y: needs to be terra object\n                               fun = \"sum\", # sum up the area\n                               na.rm = TRUE) \n    # update the column names from the initial sf df\n     zones <- cbind(eez, zones_suitarea) %>% \n     # clean the dataframe\n       dplyr::select(rgn, area_km2, area) %>% # select columns I care about\n       rename(\"suitable_area\" = \"area\") # rename to something prettier\n    \n#........................STEP 4: Mapping.........................\n map <- tm_shape(zones) + # vector data, use tmshape. \n    tm_graticules() + # add graticules at this layer\n \n# next layer: fill by area of suitable habitat\n  tm_polygons(fill = \"suitable_area\", # column name with the values\n  # specify the color scale, using viridis because it is colorblind friendly\n              fill.scale = tm_scale(values =  viridis(2)), \n              fill.legend = tm_legend(title = \"Area of suitable habitat (km2)\", \n                                      position = tm_pos_out(\"right\"))) +\n  \n # next layer: show the outlines of the zones clearly\n  tm_borders(col = \"black\") + # borders of the counties\n\n# add map elements: title with species name\n  tm_title(text = paste0(\"Suitable habitat for \", species_name))\n\n # assign name to map\n  assign(paste0(species_name, \"_map\"), map, envir = .GlobalEnv)\n}\n```\n:::\n\n\n# Results\n\n## Use function on Oysters to ensure same output\n\nHere I can demonstrate that the function is working by using the same inputs for oysters above and comparing the output. \n\n\n::: {.cell}\n\n```{.r .cell-code}\noyster_output <- suitable_habitat(bath = bath_final,\n                  eez = eez, # eez spatial dataframe\n                  sst_c = sst_c, # raster of sea surface temp\n                  min_sst = 11, # string with the minimum temp in C\n                  max_sst = 30, # string with the max temp in C\n                  min_depth_m = 0, # string with the minimum depth in m\n                  max_depth_m = -70, # string with the maximum temp in m\n                  species_name = \"Oyster\") # string with species name)\noyster_output\n```\n\n::: {.cell-output-display}\n![Figure 1. Map of Exclusive Economic Zones off the West Coast of the USA colored by the amount of suitable habitat area for oysters in square kilometers. The suitable habitat was calculated using the thermal and depth limits of the species.](index_files/figure-html/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\nSince we see the same output, we can trust the function works and use it for other species!\n\n## Using function on new species: Red Urchin\n\nNow, I will use the workflow on a new species, Red Urchin, which will allow me to visualize the best EEZ areas to investigate for marine aquaculture for Red Urchin, and to compare this map with the map of oysters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# set parms for the function for the red sea urchin\nmin_sst <- 4.1\nmax_sst <- 10.7\nmin_depth_m <- 0\nmax_depth_m <- -125\nspecies_name <- \" Red Urchin\"\n\n# run my function\nurchin_output <- suitable_habitat(bath = bath_final,\n                  eez = eez, # eez spatial dataframe\n                  sst_c = sst_c, # raster of sea surface temp\n                  min_sst = min_sst, # string with the minimum temp in C\n                  max_sst = max_sst, # string with the max temp in C\n                  min_depth_m = min_depth_m, # string with the minimum depth in m\n                  max_depth_m = max_depth_m, # string with the maximum temp in m\n                  species_name = species_name) # string with species name)\nurchin_output\n```\n\n::: {.cell-output-display}\n![Figure 2. Map of Exclusive Economic Zones off the West Coast of the USA colored by the amount of suitable habitat area for red urchin (Mesocentrotus franciscanus) in square kilometers. The suitable habitat was calculated using the thermal and depth limits of the species.](index_files/figure-html/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n# Discussion\n\nOverall, I found that there is a vast amount of area suitable off of the West Coast of the USA for oysters (Figure 1) and for Red Sea Urchin (Figure 2), where each species has exclusive economic zones with over 4,000 square kilometers of suitable area. This work also highlights the importance of making species-specific investigations into where to invest in marine aquaculture, as the oysters had more suitable area in South, but the South-most EEZ was the worst of the options for Red Urchin, which would have more area in the North.\n\nIt is important to note that this analysis does not take all important aspects of habitability for the species, or feasibility of using the area for aquaculture. This analysis and tool should be used as a first-step to determine where to look deeper into the feasibility of building marine aquaculture for a specific species. For example, an example of a future iteration of this tool would exclude areas with low phytoplanktonic food availability when considering bivalves (Gentry et al 2017), and exclude areas that are off-limits for aquaculture, like marine protected areas (MPAs), shipping lanes, and oil rigs, as done in Gentry et al 2017. This could be incorporated into this workflow by reading in maps of the MPAs, shipping areas, and areas owned by oil rigs, and subtracting them from the suitable areas.\n\n# Works Cited\n\n## Journal articles\n\nFroehlich, Halley E., Alexandra Smith, Rebecca R. Gentry, and Benjamin S. Halpern. \"Offshore aquaculture: I know it when I see it.\" Frontiers in Marine Science 4 (2017): 154.\n\nGentry, Rebecca R., Halley E. Froehlich, Dietmar Grimm, Peter Kareiva, Michael Parke, Michael Rust, Steven D. Gaines, and Benjamin S. Halpern. \"Mapping the global potential for marine aquaculture.\" Nature ecology & evolution 1, no. 9 (2017): 1317-1324.\n\nRubilar, Tamara, and Dana Cardozo. \"Blue growth: sea urchin sustainable aquaculture, innovative approaches.\" Revista de BiologÃ­a Tropical 69 (2021): 474-486.\n\n## Data citations\n\n### SST\n\nNOAA Coral Reef Watch. NOAA Coral Reef Watch Version 3.1 Daily 5km Satellite Regional Virtual Station Time Series Data for West Coast of USA, 2008 - 2012r. College Park, Maryland, USA: NOAA Coral Reef Watch. Data set accessed at [https://coralreefwatch.noaa.gov/product/vs/data.php](https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php).\n\n### Bathymetry\n\nGEBCO Compilation Group (2022) GEBCO_2022 Grid (doi:10.5285/e0f0bb80-ab44-2739-e053-6c86abc0289c).\n\n### EEZ\n\nFlanders Marine Institute (2025): MarineRegions.org. Available online at [www.marineregions.org](www.marineregions.org). Consulted on 2025-11-25.\n\n### SeaLifeBase\n\nPalomares, M.L.D. and D. Pauly. Editors. 2025. SeaLifeBase. World Wide Web electronic publication. [www.sealifebase.org](www.sealifebase.org), version (04/2025).\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}